{% extends "base.html" %}

{% block content %}
<h1 class="mt-4">Partidor Proporcional </h1>
<hr style="border-top: 3px solid rgba(49, 165, 214, 0.5) !important">

<div class="row">
    <div class="col-md-7 pl-1 pr-0">
        <div class="row">
            <div class="col-md-12">
                <div class="card mb-4">
                    <div class="card-body">
                        <form action="/partidor" method="POST" id="form" autocomplete="off" class="needs-validation"
                            novalidate>
                            <h1 class="display-1" style="font-size: 20px;font-weight:bold;">Sección Transversal del
                                Canal</h1>

                            <hr class="mt-0">

                            <div class="form-row">
                                <div class="col-md-6">
                                    <label class="mt-2">Seleccione el tipo de sección</label>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" id="inlineCheckbox1" name="tipo" {%
                                            if data %} {% if data.tipo=='rectangular' %} checked {% endif %} {% endif %}
                                            value="rectangular" {% if history %} disabled {% endif %}>
                                        <label class="form-check-label" for="inlineCheckbox1">Rectangular</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" id="inlineCheckbox2" name="tipo"
                                            value="trapezoidal" {% if data %} {% if data.tipo=='trapezoidal' %} checked
                                            {% endif %} {% endif %} {% if history %} disabled {% endif %}>
                                        <label class="form-check-label" for="inlineCheckbox2">Trapezoidal</label>
                                    </div>
                                </div>
                            </div>
                            <hr class="oculto d-none">
                            <div class="form-row oculto d-none">
                                <div class="col-md-6">
                                    <label class="mt-2">Seleccione el tipo de partidor</label>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" id="tipoPart" name="tipoPart" {% if
                                            data %} {% if data.tipoPart=='fijo' %} checked {% endif %} {% endif %}
                                            value="fijo" {% if history %} disabled {% endif %} required>
                                        <label class="form-check-label" for="tipoPart">Fijo</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" id="tipoPart2" name="tipoPart"
                                            value="movil" {% if data %} {% if data.tipoPart=='movil' %} checked {% endif
                                            %} {% endif %} {% if history %} disabled {% endif %} required>
                                        <label class="form-check-label" for="tipoPart2">Móvil</label>
                                        <div class="invalid-feedback">
                                            Debe seleccionar el tipo de partidor
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <hr class="mt-1 mb-2 oculto d-none">
                            <h1 class="oculto d-none" style="font-size: 20px;font-weight:bold;">
                                Canal Entrante (Ce)
                            </h1>
                            <hr class="mt-0 mb-2 oculto d-none">

                            <div class="form-row oculto d-none">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="small mb-1" for="caudal">Caudal Qe (m³/s)</label>
                                        <input {% if history %} disabled {% endif %} {% if data %}
                                            value="{{data.caudal_entrante}}" {% endif %} required class="form-control"
                                            id="caudal_entrante" name="caudal_entrante" type="number" min="0.0001"
                                            max="0.5" step="any" placeholder="Qe [≤ 0.5]" />
                                        <div class="invalid-feedback">Ingrese un valor de caudal mayor a cero y menor o
                                            igual a
                                            0.5 m³/s</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="small mb-1" for="base_entrante">Base del canal b (m)</label>
                                        <input {% if history %} disabled {% endif %} {% if data %}
                                            value="{{data.base_entrante}}" {% endif %} required class="form-control"
                                            id="base_entrante" name="base_entrante" type="number" min="0.0001"
                                            step="any" placeholder="b [> 0]" />
                                        <div class="invalid-feedback">Ingrese un valor de Base del canal mayor a cero
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="small mb-1" for="tirante_entrante">Tirante y (m)</label>
                                        <input {% if history %} disabled {% endif %} {% if data %}
                                            value="{{data.tirante_entrante}}" {% endif %} required class="form-control"
                                            id="tirante_entrante" name="tirante_entrante" type="number" min="0.0001"
                                            step="any" placeholder="y [> 0] " />
                                        <div class="invalid-feedback">Ingrese un valor de tirante mayor a cero</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="small mb-1" for="pendiente">Pendiente s</label>
                                        <input {% if history %} disabled {% endif %} {% if data %}
                                            value="{{data.pendiente}}" {% endif %} required class="form-control"
                                            id="pendiente" name="pendiente" type="number" min="0.0001" step="any"
                                            placeholder="s [> 0] " />
                                        <div class="invalid-feedback">Ingrese un valor de pendiente mayor a cero</div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row oculto d-none">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="rugosidad" class="small mb-1">Rugosidad n</label>
                                        <input {% if history %} disabled {% endif %} {% if data %}
                                            value="{{data.rugosidad}}" {% endif %} required min="0.0001" step="any"
                                            type="number" name="rugosidad" id="rugosidad" class="form-control mt-md-3"
                                            placeholder="n [> 0]">
                                        <div class="invalid-feedback">Ingrese un valor de rugosidad mayor a cero</div>
                                    </div>
                                </div>
                                <div class="col-md-3 trape">
                                    <div class="form-group">
                                        <label for="talud_entrante" class="small mb-1">Talud z</label>
                                        <input {% if history %} disabled {% endif %} {% if data %}
                                            value="{{data.talud_entrante}}" {% endif %} required min="0.0001" step="any"
                                            type="number" name="talud_entrante" id="talud_entrante"
                                            class="trape-input form-control mt-md-3" placeholder="z [> 0]">
                                        <div class="invalid-feedback">Ingrese un valor de talud mayor a cero</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="long_vertedero" class="small mb-1">Longitud vertedero <br>Lv
                                            (m)</label>
                                        <input {% if data %}
                                            value="{{data.long_vertedero}}" {% endif %} disabled required min="0.0001" step="any"
                                            type="number" name="long_vertedero" id="long_vertedero"
                                            class="trape-input form-control" placeholder="Lv [> 0]">
                                        <div class="invalid-feedback">Ingrese un valor de longitud mayor a cero </div>
                                    </div>
                                </div>
                                <div class="col-md-3 trape">
                                    <div class="form-group">
                                        <label for="angulo_transicion" class="small mb-1">Ángulo de transición (º) [12.5
                                            ≤ θ ≤
                                            22.5] </label>
                                        <input {% if history %} disabled {% endif %} {% if data %}
                                            value="{{data.angulo_transicion}}" {% endif %} required min="12.5"
                                            max="22.5" step="any" type="number" name="angulo_transicion"
                                            id="angulo_transicion" class="trape-input form-control" placeholder="θ">
                                        <div class="invalid-feedback">Ingrese un valor de angulo θ entre 12.5º y 22.5º
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="cota_a" class="small mb-1">Cota A (m)</label>
                                        <input {% if history %} disabled {% endif %} {% if data %}
                                            value="{{data.cota_a}}" {% endif %} required min="0" step="any"
                                            type="number" name="cota_a" id="cota_a" class="form-control"
                                            placeholder="Cota [≥ 0]">
                                        <div class="invalid-feedback">Ingrese un valor de cota A mayor o igual a cero
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <hr class="mt-0 mb-2 oculto d-none">
                            <h1 class="oculto d-none" style="font-size: 20px;font-weight:bold;">
                                Canal Pasante (Cp)
                            </h1>
                            <hr class="mt-0 mb-2 oculto d-none">

                            <div class="form-row oculto d-none">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="small mb-1" for="caudal_pasante">Caudal Qp (m³/s)</label>
                                        <input {% if history %} disabled {% endif %} {% if data %}
                                            value="{{data.caudal_pasante}}" {% endif %} required class="form-control"
                                            id="caudal_pasante" name="caudal_pasante" type="number" min="0.0001"
                                            max="0.5" step="any" placeholder="Qp [≤ 0.5]" />
                                        <div class="invalid-feedback">Ingrese un valor de caudal mayor a cero y menor o
                                            igual a
                                            0.5 m³/s</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="small mb-1" for="base_pasante">Base del canal bp (m)</label>
                                        <input {% if history %} disabled {% endif %} {% if data %}
                                            value="{{data.base_pasante}}" {% endif %} required class="form-control"
                                            id="base_pasante" name="base_pasante" type="number" min="0.0001" step="any"
                                            placeholder="b [> 0]" />
                                        <div class="invalid-feedback">Ingrese un valor de Base del canal mayor a cero
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="small mb-1" for="tirante_pasante">Tirante yp (m)</label>
                                        <input {% if history %} disabled {% endif %} {% if data %}
                                            value="{{data.tirante_pasante}}" {% endif %} required class="form-control"
                                            id="tirante_pasante" name="tirante_pasante" type="number" min="0.0001"
                                            step="any" placeholder="y [> 0] " />
                                        <div class="invalid-feedback">Ingrese un valor de tirante mayor a cero</div>
                                    </div>
                                </div>
                                <div class="col-md-3 trape">
                                    <div class="form-group">
                                        <label for="talud_pasante" class="small mb-1">Talud zp</label>
                                        <input {% if history %} disabled {% endif %} {% if data %}
                                            value="{{data.talud_pasante}}" {% endif %} required min="0.0001" step="any"
                                            type="number" name="talud_pasante" id="talud_pasante"
                                            class="trape-input form-control" placeholder="z [> 0]">
                                        <div class="invalid-feedback">Ingrese un valor de talud mayor a cero</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="cota_b" class="small mb-1">Cota B (m)</label>
                                        <input {% if history %} disabled {% endif %} {% if data %}
                                            value="{{data.cota_b}}" {% endif %} required min="0" step="any"
                                            type="number" name="cota_b" id="cota_b" class="form-control"
                                            placeholder="Cota [≥ 0]">
                                        <div class="invalid-feedback">Ingrese un valor de cota B mayor o igual a cero
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <hr class="mt-0 mb-2 oculto d-none">
                            <h1 class="oculto d-none" style="font-size: 20px;font-weight:bold;">
                                Canal Saliente (Cs)
                            </h1>
                            <hr class="mt-0 mb-2 oculto d-none">


                            <div class="form-row oculto d-none">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="small mb-1" for="caudal_saliente">Caudal Qs (m³/s)</label>
                                        <input {% if history %} disabled {% endif %} {% if data %}
                                            value="{{data.caudal_saliente}}" {% endif %} required class="form-control"
                                            id="caudal_saliente" name="caudal_saliente" type="number" min="0.0001"
                                            max="0.5" step="any" placeholder="Qs [≤ 0.5]" />
                                        <div class="invalid-feedback">Ingrese un valor de caudal mayor a cero y menor o
                                            igual a
                                            0.5 m³/s</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="small mb-1" for="base_saliente">Base del canal bs (m)</label>
                                        <input {% if history %} disabled {% endif %} {% if data %}
                                            value="{{data.base_saliente}}" {% endif %} required class="form-control"
                                            id="base_saliente" name="base_saliente" type="number" min="0.0001"
                                            step="any" placeholder="b [> 0]" />
                                        <div class="invalid-feedback">Ingrese un valor de Base del canal mayor a cero
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="small mb-1" for="tirante_saliente">Tirante ys (m)</label>
                                        <input {% if history %} disabled {% endif %} {% if data %}
                                            value="{{data.tirante_saliente}}" {% endif %} required class="form-control"
                                            id="tirante_saliente" name="tirante_saliente" type="number" min="0.0001"
                                            step="any" placeholder="y [> 0] " />
                                        <div class="invalid-feedback">Ingrese un valor de tirante mayor a cero</div>
                                    </div>
                                </div>
                                <div class="col-md-3 trape">
                                    <div class="form-group">
                                        <label for="talud_saliente" class="small mb-1">Talud zs</label>
                                        <input {% if history %} disabled {% endif %} {% if data %}
                                            value="{{data.talud_saliente}}" {% endif %} required min="0.0001" step="any"
                                            type="number" name="talud_saliente" id="talud_saliente"
                                            class="trape-input form-control" placeholder="z [> 0]">
                                        <div class="invalid-feedback">Ingrese un valor de talud mayor a cero</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="cota_c" class="small mb-1">Cota C (m)</label>
                                        <input {% if history %} disabled {% endif %} {% if data %}
                                            value="{{data.cota_c}}" {% endif %} required min="0" step="any"
                                            type="number" name="cota_c" id="cota_c" class="form-control"
                                            placeholder="Cota [≥ 0]">
                                        <div class="invalid-feedback">Ingrese un valor de cota C mayor o igual a cero
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% if not history %}
                            <div class="form-group mt-4 mb-0 oculto d-none"><button type="submit"
                                    class="btn btn-primary btn-block">Calcular</button></div>
                            {% endif %}
                        </form>
                    </div>
                </div>
            </div>
        </div>
        {% if resultados %}
        <div class="row">
            <div class="col-md-12">
                <div class="car mb-4">
                    <div class="card-body">
                        <h1 class="" style="font-size: 20px;font-weight:bold;">Resultados para el canal entrante</h1>
                        <hr>
                        <div class="form-row">
                            <div class="col-md-3">
                                <div class="form-group"><label for="" class="small mb-1">Tirante normal
                                        [<b>y1</b>,m]</label>
                                    <input disabled name="" id="" class="form-control"
                                        value="{{resultados.tirante_normal}}">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group"><label for="" class="small mb-1">Tirante crítico [<b>yc</b>,
                                        m]</label>
                                    <input disabled name="" id="" class="form-control"
                                        value="{{resultados.tirante_critico}}">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group"><label for="" class="small mb-1"><span
                                            class="red"><b>*</b></span>Velocidad [<b>V</b>, m/s]</label>
                                    <input disabled name="" id="" class="form-control" value="{{resultados.velocidad}}">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group"><label for="" class="small mb-1">Borde libre [<b>Bl</b>,
                                        m]</label>
                                    <input disabled name="" id="" class="form-control"
                                        value="{{resultados.borde_libre}}">
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="col-md-12">
                                <p class="red mb-0"> <b>*Condiciones de Diseño:</b></p> <b>V ≤ 1.0 m/s</b><br>
                                <b>45° < θ < 70°</b> <br>
                                        En caso de no cumplirse, verificar relación entre Qd y b y/o modificar ΔH
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

    </div>
    <div class="col-md-5">
        <div class="card mb-4">
            <div class="card-body">
                <div class="row rect">
                    <div class="col-md-12 imagen"><img style="width: inherit;" src="/static/images/canalR.png"
                            alt="Sección Transversal del canal">
                        <div class="mt-3 mb-5">Sección transversal del canal rectangular</div>
                    </div>
                </div>
                <div class="row trape">
                    <div class="col-md-12 imagen"><img style="width: inherit;" src="/static/images/canaltrapez.png"
                            alt="Sección Transversal del canal">
                        <div class="mt-3 mb-5">Sección transversal del canal trapezoidal</div>
                    </div>
                </div>
                <div class="row movil d-none">
                    <div class="col-md-12 imagen"><img style="width: inherit;" src="/static/images/movilColor.png"
                            alt="Parametros partidor movil. Vista en planta">
                        <div class="mt-3 mb-5">Parametros partidor movil. Vista en planta</div>
                    </div>
                </div>
                <div class="row fijo d-none">
                    <div class="col-md-12 imagen"><img style="width: inherit;"
                            src="/static/images/partidorPlantaColor.png" alt="Parametros partidor. Vista en planta">
                        <div class="mt-3 mb-5">Parametros partidor. Vista en planta</div>
                    </div>
                </div>
                <div class="row perfil d-none">
                    <div class="col-md-12 imagen"><img style="width: inherit;" src="/static/images/partidorPerfil.png"
                            alt="Parametros partidos. Vista en perfil">
                        <div class="mt-3 mb-5">Parametros partidos. Vista en perfil</div>
                    </div>
                </div>
                <div class="row movilR d-none">
                    <div class="col-md-12 imagen"><img style="width: inherit;" id="movilR" src="/static/images/partidorPerfil.png"
                            alt="Parametros partidos. Vista en perfil">
                        <div class="mt-3 mb-5">Parametros partidos. Vista en perfil</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extraJs %}
<script>
    $(document).ready(function () {
        $('input[type=radio][name=tipoPart]').change(function () {
            if (this.value == 'movil') {
                $(".movil").removeClass('d-none');
                $(".fijo").addClass('d-none');
            } else {
                $(".fijo").removeClass('d-none');
                $(".movil").addClass('d-none');
            }
            $(".perfil").removeClass('d-none')
        });

        $('#base_entrante').change(function(){
            $("#long_vertedero").val(this.value)
        })

        $('input[type=radio][name=tipo]').change(function () {
            if (this.value == 'rectangular') {
                $(".rect").removeClass('d-none');
                $(".trape").addClass('d-none');
                $("#cota_a").addClass('mt-md-3');
                $(".trape-input").prop('required', false);
            }
            else if (this.value == 'trapezoidal') {
                $(".trape").removeClass('d-none');
                $("#cota_a").removeClass('mt-md-3');
                $(".rect").addClass('d-none');
                $(".trape-input").prop('required', true);
            }
            $(".oculto").removeClass('d-none')
        });
    })
</script>
{% endblock %}